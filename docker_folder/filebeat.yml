filebeat.inputs:
  - type: filestream
    id: honeypot-logs
    enabled: true
    paths:
      - /app/logs/*.log
    json.keys_under_root: true
    json.overwrite_keys: true
    json.message_key: "message"
    multiline.pattern: '^{'
    multiline.negate: true
    multiline.match: after

processors:
  - timestamp:
      field: timestamp
      layouts:
        - '2006-01-02T15:04:05.000000Z07:00'

# ILM must be enabled for data streams
setup.ilm.enabled: true

# Remove all template.name / pattern â€” Filebeat will use data stream templates
setup.template.enabled: true

output.elasticsearch:
  hosts: ["https://10.0.0.135:9200"]
  username: "elastic"
  password: "<your-password>"
  ssl.verification_mode: none

# Use data stream routing
output.elasticsearch.indices:
  - index: "honeypot-logs"
    pipeline: "honeypot-ecs-pipeline"
